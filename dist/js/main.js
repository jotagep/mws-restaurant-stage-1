let restaurants,neighborhoods,cuisines,showMap=!1;var map,markers=[];const myLazyLoad=new LazyLoad;document.addEventListener("DOMContentLoaded",e=>{fetchNeighborhoods(),fetchCuisines(),DBHelper.openDB(),registerServiceWorker(),updateRestaurants()}),fetchNeighborhoods=(()=>{DBHelper.fetchNeighborhoods((e,t)=>{e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})}),fillNeighborhoodsHTML=((e=self.neighborhoods)=>{const t=document.getElementById("neighborhoods-select");e.forEach(e=>{const a=document.createElement("option");a.innerHTML=e,a.value=e,t.append(a)})}),fetchCuisines=(()=>{DBHelper.fetchCuisines((e,t)=>{e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})}),fillCuisinesHTML=((e=self.cuisines)=>{const t=document.getElementById("cuisines-select");e.forEach(e=>{const a=document.createElement("option");a.innerHTML=e,a.value=e,t.append(a)})}),window.initMap=(()=>{self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),addMarkersToMap()}),updateRestaurants=(()=>{const e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),a=e.selectedIndex,n=t.selectedIndex,s=e[a].value,r=t[n].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(s,r,(e,t)=>{e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML(),myLazyLoad.update())})}),resetRestaurants=(e=>{self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(e=>e.setMap(null)),self.markers=[],self.restaurants=e}),fillRestaurantsHTML=((e=self.restaurants)=>{const t=document.getElementById("restaurants-list");e.forEach(e=>{t.append(createRestaurantHTML(e))}),showMap&&addMarkersToMap()}),createRestaurantHTML=(e=>{const t=document.createElement("li");t.className="card";const a=document.createElement("picture");t.append(a);const n=document.createElement("source");n.type="image/webp",n.setAttribute("data-srcset",`${DBHelper.imageRespForRestaurant(e,"large","webp")}`),n.media="(min-width: 511px) and (max-width: 640px)",a.append(n);const s=document.createElement("source");s.type="image/webp",s.setAttribute("data-srcset",`${DBHelper.imageRespForRestaurant(e,"medium","webp")}`),s.media="(min-width: 411px) and (max-width: 510px),\n                       (min-width: 791px) and (max-width: 930px),\n                       (min-width: 1191px)",a.append(s);const r=document.createElement("source");r.type="image/webp",r.setAttribute("data-srcset",`${DBHelper.imageRespForRestaurant(e,"small","webp")}`),r.media="(max-width: 410px),\n                       (min-width: 650px) and (max-width: 800px),\n                       (min-width: 950px) and (max-width: 1200px)",a.append(r);const o=document.createElement("source");o.type="image/jpeg",o.setAttribute("data-srcset",`${DBHelper.imageRespForRestaurant(e,"large")}`),o.media="(min-width: 511px) and (max-width: 640px)",a.append(o);const i=document.createElement("source");i.type="image/jpeg",i.setAttribute("data-srcset",`${DBHelper.imageRespForRestaurant(e,"medium")}`),i.media="(min-width: 411px) and (max-width: 510px),\n                         (min-width: 791px) and (max-width: 930px),\n                         (min-width: 1191px)",a.append(i);const d=document.createElement("img");d.type="image/jpeg",d.className="card__img",d.setAttribute("data-src",`${DBHelper.imageRespForRestaurant(e,"small")}`),d.media="(max-width: 410px),\n                         (min-width: 650px) and (max-width: 800px),\n                         (min-width: 950px) and (max-width: 1200px)",d.alt=`${e.name}`,a.append(d);const c=document.createElement("h3");c.className="card__title",c.innerHTML=e.name,t.append(c);const l=document.createElement("p");l.className="card__description",l.innerHTML=e.neighborhood,t.append(l);const p=document.createElement("p");p.className="card__description",p.innerHTML=e.address,t.append(p);const m=document.createElement("a");return m.className="card__button",m.setAttribute("role","button"),m.setAttribute("aria-label","Go to restaurant details"),m.innerHTML="View Details",m.href=DBHelper.urlForRestaurant(e),t.append(m),t}),addMarkersToMap=((e=self.restaurants)=>{e.forEach(e=>{const t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",()=>{window.location.href=t.url}),self.markers.push(t)})}),toggleMap=(()=>{const e=document.getElementById("map"),t=document.getElementById("btn-map");"none"===e.style.display?(showMap=!0,t.innerText="Hide Map",t.setAttribute("aria-label","Hide Map"),e.style.display="block",window.initMap()):(showMap=!1,t.innerText="Show Map",t.setAttribute("aria-label","Show Map"),e.style.display="none")}),registerServiceWorker=(()=>{"serviceWorker"in navigator?window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("ServiceWorker registration successful with scope: ",e.scope)}).catch(e=>{console.log("Service Worker failed: ",e)})}):console.log("== Service Worker not supported ==")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsicmVzdGF1cmFudHMiLCJuZWlnaGJvcmhvb2RzIiwiY3Vpc2luZXMiLCJzaG93TWFwIiwibWFwIiwibWFya2VycyIsIm15TGF6eUxvYWQiLCJMYXp5TG9hZCIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiZmV0Y2hOZWlnaGJvcmhvb2RzIiwiZmV0Y2hDdWlzaW5lcyIsIkRCSGVscGVyIiwib3BlbkRCIiwicmVnaXN0ZXJTZXJ2aWNlV29ya2VyIiwidXBkYXRlUmVzdGF1cmFudHMiLCJlcnJvciIsImNvbnNvbGUiLCJzZWxmIiwiZmlsbE5laWdoYm9yaG9vZHNIVE1MIiwic2VsZWN0IiwiZ2V0RWxlbWVudEJ5SWQiLCJmb3JFYWNoIiwibmVpZ2hib3Job29kIiwib3B0aW9uIiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsInZhbHVlIiwiYXBwZW5kIiwiZmlsbEN1aXNpbmVzSFRNTCIsImN1aXNpbmUiLCJ3aW5kb3ciLCJpbml0TWFwIiwiZ29vZ2xlIiwibWFwcyIsIk1hcCIsInpvb20iLCJjZW50ZXIiLCJsYXQiLCJsbmciLCJzY3JvbGx3aGVlbCIsImFkZE1hcmtlcnNUb01hcCIsImNTZWxlY3QiLCJuU2VsZWN0IiwiY0luZGV4Iiwic2VsZWN0ZWRJbmRleCIsIm5JbmRleCIsImZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZCIsInJlc2V0UmVzdGF1cmFudHMiLCJmaWxsUmVzdGF1cmFudHNIVE1MIiwidXBkYXRlIiwibSIsInNldE1hcCIsInVsIiwicmVzdGF1cmFudCIsImNyZWF0ZVJlc3RhdXJhbnRIVE1MIiwibGkiLCJjbGFzc05hbWUiLCJwaWN0dXJlIiwiV2VicF9sYXJnZSIsInR5cGUiLCJzZXRBdHRyaWJ1dGUiLCJpbWFnZVJlc3BGb3JSZXN0YXVyYW50IiwibWVkaWEiLCJXZWJQX21lZGl1bSIsIldlYlBfc21hbGwiLCJKcGdfbGFyZ2UiLCJKcGdfbWVkaXVtIiwiaW1hZ2Vfc21hbGwiLCJhbHQiLCJuYW1lIiwiYWRkcmVzcyIsIm1vcmUiLCJocmVmIiwidXJsRm9yUmVzdGF1cmFudCIsIm1hcmtlciIsIm1hcE1hcmtlckZvclJlc3RhdXJhbnQiLCJhZGRMaXN0ZW5lciIsImxvY2F0aW9uIiwidXJsIiwicHVzaCIsInRvZ2dsZU1hcCIsImJ0bk1hcCIsInN0eWxlIiwiZGlzcGxheSIsImlubmVyVGV4dCIsIm5hdmlnYXRvciIsInNlcnZpY2VXb3JrZXIiLCJyZWdpc3RlciIsInRoZW4iLCJyZWciLCJsb2ciLCJzY29wZSIsImNhdGNoIiwiZXJyIl0sIm1hcHBpbmdzIjoiQUFBQSxJQUFJQSxZQUFhQyxjQUFlQyxTQUM1QkMsU0FBVSxFQUNkLElBQUlDLElBQ0FDLFdBRUosTUFBTUMsV0FBYSxJQUFJQyxTQUt2QkMsU0FBU0MsaUJBQWlCLG1CQUFvQkMsSUFDNUNDLHFCQUNBQyxnQkFDQUMsU0FBU0MsU0FDVEMsd0JBQ0FDLHNCQU1GTCxtQkFBcUIsTUFDbkJFLFNBQVNGLG1CQUFtQixDQUFDTSxFQUFPaEIsS0FDOUJnQixFQUVGQyxRQUFRRCxNQUFNQSxJQUVkRSxLQUFLbEIsY0FBZ0JBLEVBQ3JCbUIsNkJBUU5BLHNCQUF3QixFQUFDbkIsRUFBZ0JrQixLQUFLbEIsaUJBQzVDLE1BQU1vQixFQUFTYixTQUFTYyxlQUFlLHdCQUN2Q3JCLEVBQWNzQixRQUFRQyxJQUNwQixNQUFNQyxFQUFTakIsU0FBU2tCLGNBQWMsVUFDdENELEVBQU9FLFVBQVlILEVBQ25CQyxFQUFPRyxNQUFRSixFQUNmSCxFQUFPUSxPQUFPSixPQU9sQmIsY0FBZ0IsTUFDZEMsU0FBU0QsY0FBYyxDQUFDSyxFQUFPZixLQUN6QmUsRUFFRkMsUUFBUUQsTUFBTUEsSUFFZEUsS0FBS2pCLFNBQVdBLEVBQ2hCNEIsd0JBUU5BLGlCQUFtQixFQUFDNUIsRUFBV2lCLEtBQUtqQixZQUNsQyxNQUFNbUIsRUFBU2IsU0FBU2MsZUFBZSxtQkFFdkNwQixFQUFTcUIsUUFBUVEsSUFDZixNQUFN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RixNQUFNQyxRQUFVLFVBUXhCdEUsc0JBQXdCLE1BQ2xCLGtCQUFtQndFLFVBQ3JCdkQsT0FBT3ZCLGlCQUFpQixPQUFRLEtBQzlCOEUsVUFBVUMsY0FDUEMsU0FBUyxVQUNUQyxLQUFLQyxJQUNKekUsUUFBUTBFLElBQUkscURBQXNERCxFQUFJRSxTQUV2RUMsTUFBTUMsSUFFTDdFLFFBQVEwRSxJQUFJLDBCQUEyQkcsT0FJN0M3RSxRQUFRMEUsSUFBSSIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IHJlc3RhdXJhbnRzLCBuZWlnaGJvcmhvb2RzLCBjdWlzaW5lcztcbmxldCBzaG93TWFwID0gZmFsc2U7XG52YXIgbWFwO1xudmFyIG1hcmtlcnMgPSBbXTtcblxuY29uc3QgbXlMYXp5TG9hZCA9IG5ldyBMYXp5TG9hZCgpO1xuXG4vKipcbiAqIEZldGNoIG5laWdoYm9yaG9vZHMgYW5kIGN1aXNpbmVzIGFzIHNvb24gYXMgdGhlIHBhZ2UgaXMgbG9hZGVkLlxuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBldmVudCA9PiB7XG4gIGZldGNoTmVpZ2hib3Job29kcygpO1xuICBmZXRjaEN1aXNpbmVzKCk7XG4gIERCSGVscGVyLm9wZW5EQigpO1xuICByZWdpc3RlclNlcnZpY2VXb3JrZXIoKTtcbiAgdXBkYXRlUmVzdGF1cmFudHMoKTtcbn0pO1xuXG4vKipcbiAqIEZldGNoIGFsbCBuZWlnaGJvcmhvb2RzIGFuZCBzZXQgdGhlaXIgSFRNTC5cbiAqL1xuZmV0Y2hOZWlnaGJvcmhvb2RzID0gKCkgPT4ge1xuICBEQkhlbHBlci5mZXRjaE5laWdoYm9yaG9vZHMoKGVycm9yLCBuZWlnaGJvcmhvb2RzKSA9PiB7XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICAvLyBHb3QgYW4gZXJyb3JcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZWxmLm5laWdoYm9yaG9vZHMgPSBuZWlnaGJvcmhvb2RzO1xuICAgICAgZmlsbE5laWdoYm9yaG9vZHNIVE1MKCk7XG4gICAgfVxuICB9KTtcbn07XG5cbi8qKlxuICogU2V0IG5laWdoYm9yaG9vZHMgSFRNTC5cbiAqL1xuZmlsbE5laWdoYm9yaG9vZHNIVE1MID0gKG5laWdoYm9yaG9vZHMgPSBzZWxmLm5laWdoYm9yaG9vZHMpID0+IHtcbiAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuZWlnaGJvcmhvb2RzLXNlbGVjdFwiKTtcbiAgbmVpZ2hib3Job29kcy5mb3JFYWNoKG5laWdoYm9yaG9vZCA9PiB7XG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcbiAgICBvcHRpb24uaW5uZXJIVE1MID0gbmVpZ2hib3Job29kO1xuICAgIG9wdGlvbi52YWx1ZSA9IG5laWdoYm9yaG9vZDtcbiAgICBzZWxlY3QuYXBwZW5kKG9wdGlvbik7XG4gIH0pO1xufTtcblxuLyoqXG4gKiBGZXRjaCBhbGwgY3Vpc2luZXMgYW5kIHNldCB0aGVpciBIVE1MLlxuICovXG5mZXRjaEN1aXNpbmVzID0gKCkgPT4ge1xuICBEQkhlbHBlci5mZXRjaEN1aXNpbmVzKChlcnJvciwgY3Vpc2luZXMpID0+IHtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIC8vIEdvdCBhbiBlcnJvciFcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZWxmLmN1aXNpbmVzID0gY3Vpc2luZXM7XG4gICAgICBmaWxsQ3Vpc2luZXNIVE1MKCk7XG4gICAgfVxuICB9KTtcbn07XG5cbi8qKlxuICogU2V0IGN1aXNpbmVzIEhUTUwuXG4gKi9cbmZpbGxDdWlzaW5lc0hUTUwgPSAoY3Vpc2luZXMgPSBzZWxmLmN1aXNpbmVzKSA9PiB7XG4gIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY3Vpc2luZXMtc2VsZWN0XCIpO1xuXG4gIGN1aXNpbmVzLmZvckVhY2goY3Vpc2luZSA9PiB7XG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcbiAgICBvcHRpb24uaW5uZXJIVE1MID0gY3Vpc2luZTtcbiAgICBvcHRpb24udmFsdWUgPSBjdWlzaW5lO1xuICAgIHNlbGVjdC5hcHBlbmQob3B0aW9uKTtcbiAgfSk7XG59O1xuXG4vKipcbiAqIEluaXRpYWxpemUgR29vZ2xlIG1hcCwgY2FsbGVkIGZyb20gSFRNTC5cbiAqL1xud2luZG93LmluaXRNYXAgPSAoKSA9PiB7XG4gIGxldCBsb2MgPSB7XG4gICAgbGF0OiA0MC43MjIyMTYsXG4gICAgbG5nOiAtNzMuOTg3NTAxXG4gIH07XG4gIHNlbGYubWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1hcFwiKSwge1xuICAgIHpvb206IDEyLFxuICAgIGNlbnRlcjogbG9jLFxuICAgIHNjcm9sbHdoZWVsOiBmYWxzZVxuICB9KTtcbiAgYWRkTWFya2Vyc1RvTWFwKCk7XG59O1xuXG4vKipcbiAqIFVwZGF0ZSBwYWdlIGFuZCBtYXAgZm9yIGN1cnJlbnQgcmVzdGF1cmFudHMuXG4gKi9cbnVwZGF0ZVJlc3RhdXJhbnRzID0gKCkgPT4ge1xuICBjb25zdCBjU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjdWlzaW5lcy1zZWxlY3RcIik7XG4gIGNvbnN0IG5TZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5laWdoYm9yaG9vZHMtc2VsZWN0XCIpO1xuXG4gIGNvbnN0IGNJbmRleCA9IGNTZWxlY3Quc2VsZWN0ZWRJbmRleDtcbiAgY29uc3QgbkluZGV4ID0gblNlbGVjdC5zZWxlY3RlZEluZGV4O1xuXG4gIGNvbnN0IGN1aXNpbmUgPSBjU2VsZWN0W2NJbmRleF0udmFsdWU7XG4gIGNvbnN0IG5laWdoYm9yaG9vZCA9IG5TZWxlY3RbbkluZGV4XS52YWx1ZTtcblxuICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoXG4gICAgY3Vpc2luZSxcbiAgICBuZWlnaGJvcmhvb2QsXG4gICAgKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIC8vIEdvdCBhbiBlcnJvciFcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNldFJlc3RhdXJhbnRzKHJlc3RhdXJhbnRzKTtcbiAgICAgICAgZmlsbFJlc3RhdXJhbnRzSFRNTCgpO1xuICAgICAgICBteUxhenlMb2FkLnVwZGF0ZSgpO1xuICAgICAgfVxuICAgIH1cbiAgKTtcbn07XG5cbi8qKlxuICogQ2xlYXIgY3VycmVudCByZXN0YXVyYW50cywgdGhlaXIgSFRNTCBhbmQgcmVtb3ZlIHRoZWlyIG1hcCBtYXJrZXJzLlxuICovXG5yZXNldFJlc3RhdXJhbnRzID0gcmVzdGF1cmFudHMgPT4ge1xuICAvLyBSZW1vdmUgYWxsIHJlc3RhdXJhbnRzXG4gIHNlbGYucmVzdGF1cmFudHMgPSBbXTtcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlc3RhdXJhbnRzLWxpc3RcIik7XG4gIHVsLmlubmVySFRNTCA9IFwiXCI7XG5cbiAgLy8gUmVtb3ZlIGFsbCBtYXAgbWFya2Vyc1xuICBzZWxmLm1hcmtlcnMuZm9yRWFjaChtID0+IG0uc2V0TWFwKG51bGwpKTtcbiAgc2VsZi5tYXJrZXJzID0gW107XG4gIHNlbGYucmVzdGF1cmFudHMgPSByZXN0YXVyYW50cztcbn07XG5cbi8qKlxuICogQ3JlYXRlIGFsbCByZXN0YXVyYW50cyBIVE1MIGFuZCBhZGQgdGhlbSB0byB0aGUgd2VicGFnZS5cbiAqL1xuZmlsbFJlc3RhdXJhbnRzSFRNTCA9IChyZXN0YXVyYW50cyA9IHNlbGYucmVzdGF1cmFudHMpID0+IHtcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlc3RhdXJhbnRzLWxpc3RcIik7XG4gIHJlc3RhdXJhbnRzLmZvckVhY2gocmVzdGF1cmFudCA9PiB7XG4gICAgdWwuYXBwZW5kKGNyZWF0ZVJlc3RhdXJhbnRIVE1MKHJlc3RhdXJhbnQpKTtcbiAgfSk7XG4gIGlmIChzaG93TWFwKSB7XG4gICAgYWRkTWFya2Vyc1RvTWFwKCk7XG4gIH1cbn07XG5cbi8qKlxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTC5cbiAqL1xuY3JlYXRlUmVzdGF1cmFudEhUTUwgPSByZXN0YXVyYW50ID0+IHtcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlcIik7XG4gIGxpLmNsYXNzTmFtZSA9IFwiY2FyZFwiO1xuXG4gIGNvbnN0IHBpY3R1cmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicGljdHVyZVwiKTtcbiAgbGkuYXBwZW5kKHBpY3R1cmUpO1xuXG4gIC8qIFNvdXJjZXMgV2ViUCBJbWFnZXMgKi9cbiAgY29uc3QgV2VicF9sYXJnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzb3VyY2VcIik7XG4gIFdlYnBfbGFyZ2UudHlwZSA9IFwiaW1hZ2Uvd2VicFwiO1xuICBXZWJwX2xhcmdlLnNldEF0dHJpYnV0ZSgnZGF0YS1zcmNzZXQnLCBgJHtEQkhlbHBlci5pbWFnZVJlc3BGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsICdsYXJnZScsICd3ZWJwJyl9YCk7XG4gIFdlYnBfbGFyZ2UubWVkaWEgPSBgKG1pbi13aWR0aDogNTExcHgpIGFuZCAobWF4LXdpZHRoOiA2NDBweClgO1xuICBwaWN0dXJlLmFwcGVuZChXZWJwX2xhcmdlKTtcblxuICBjb25zdCBXZWJQX21lZGl1bSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzb3VyY2VcIik7XG4gIFdlYlBfbWVkaXVtLnR5cGUgPSBcImltYWdlL3dlYnBcIjtcbiAgV2ViUF9tZWRpdW0uc2V0QXR0cmlidXRlKCdkYXRhLXNyY3NldCcsIGAke0RCSGVscGVyLmltYWdlUmVzcEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgJ21lZGl1bScsICd3ZWJwJyl9YCk7XG4gIFdlYlBfbWVkaXVtLm1lZGlhID0gYChtaW4td2lkdGg6IDQxMXB4KSBhbmQgKG1heC13aWR0aDogNTEwcHgpLFxuICAgICAgICAgICAgICAgICAgICAgICAobWluLXdpZHRoOiA3OTFweCkgYW5kIChtYXgtd2lkdGg6IDkzMHB4KSxcbiAgICAgICAgICAgICAgICAgICAgICAgKG1pbi13aWR0aDogMTE5MXB4KWA7XG4gIHBpY3R1cmUuYXBwZW5kKFdlYlBfbWVkaXVtKTtcblxuICBjb25zdCBXZWJQX3NtYWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNvdXJjZVwiKTtcbiAgV2ViUF9zbWFsbC50eXBlID0gXCJpbWFnZS93ZWJwXCI7XG4gIFdlYlBfc21hbGwuc2V0QXR0cmlidXRlKCdkYXRhLXNyY3NldCcsIGAke0RCSGVscGVyLmltYWdlUmVzcEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgJ3NtYWxsJywgJ3dlYnAnKX1gKTtcbiAgV2ViUF9zbWFsbC5tZWRpYSA9IGAobWF4LXdpZHRoOiA0MTBweCksXG4gICAgICAgICAgICAgICAgICAgICAgIChtaW4td2lkdGg6IDY1MHB4KSBhbmQgKG1heC13aWR0aDogODAwcHgpLFxuICAgICAgICAgICAgICAgICAgICAgICAobWluLXdpZHRoOiA5NTBweCkgYW5kIChtYXgtd2lkdGg6IDEyMDBweClgO1xuICBwaWN0dXJlLmFwcGVuZChXZWJQX3NtYWxsKTtcblxuICAvKiBTb3VyY2VzIEpQRUcgSW1hZ2VzICovXG4gIGNvbnN0IEpwZ19sYXJnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzb3VyY2VcIik7XG4gIEpwZ19sYXJnZS50eXBlID0gXCJpbWFnZS9qcGVnXCI7XG4gIEpwZ19sYXJnZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3Jjc2V0JywgYCR7REJIZWxwZXIuaW1hZ2VSZXNwRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCAnbGFyZ2UnKX1gKTtcbiAgSnBnX2xhcmdlLm1lZGlhID0gYChtaW4td2lkdGg6IDUxMXB4KSBhbmQgKG1heC13aWR0aDogNjQwcHgpYDtcbiAgcGljdHVyZS5hcHBlbmQoSnBnX2xhcmdlKTtcblxuICBjb25zdCBKcGdfbWVkaXVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNvdXJjZVwiKTtcbiAgSnBnX21lZGl1bS50eXBlID0gXCJpbWFnZS9qcGVnXCI7XG4gIEpwZ19tZWRpdW0uc2V0QXR0cmlidXRlKCdkYXRhLXNyY3NldCcsIGAke0RCSGVscGVyLmltYWdlUmVzcEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgJ21lZGl1bScpfWApO1xuICBKcGdfbWVkaXVtLm1lZGlhID0gYChtaW4td2lkdGg6IDQxMXB4KSBhbmQgKG1heC13aWR0aDogNTEwcHgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgIChtaW4td2lkdGg6IDc5MXB4KSBhbmQgKG1heC13aWR0aDogOTMwcHgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgIChtaW4td2lkdGg6IDExOTFweClgO1xuICBwaWN0dXJlLmFwcGVuZChKcGdfbWVkaXVtKTtcblxuICBjb25zdCBpbWFnZV9zbWFsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbWdcIik7XG4gIGltYWdlX3NtYWxsLnR5cGUgPSBcImltYWdlL2pwZWdcIjtcbiAgaW1hZ2Vfc21hbGwuY2xhc3NOYW1lID0gXCJjYXJkX19pbWdcIjtcbiAgaW1hZ2Vfc21hbGwuc2V0QXR0cmlidXRlKCdkYXRhLXNyYycsIGAke0RCSGVscGVyLmltYWdlUmVzcEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgJ3NtYWxsJyl9YCk7XG4gIGltYWdlX3NtYWxsLm1lZGlhID0gYChtYXgtd2lkdGg6IDQxMHB4KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAobWluLXdpZHRoOiA2NTBweCkgYW5kIChtYXgtd2lkdGg6IDgwMHB4KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAobWluLXdpZHRoOiA5NTBweCkgYW5kIChtYXgtd2lkdGg6IDEyMDBweClgO1xuICBpbWFnZV9zbWFsbC5hbHQgPSBgJHtyZXN0YXVyYW50Lm5hbWV9YDtcbiAgcGljdHVyZS5hcHBlbmQoaW1hZ2Vfc21hbGwpO1xuXG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDNcIik7XG4gIG5hbWUuY2xhc3NOYW1lID0gXCJjYXJkX190aXRsZVwiO1xuICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcbiAgbGkuYXBwZW5kKG5hbWUpO1xuXG4gIGNvbnN0IG5laWdoYm9yaG9vZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xuICBuZWlnaGJvcmhvb2QuY2xhc3NOYW1lID0gXCJjYXJkX19kZXNjcmlwdGlvblwiO1xuICBuZWlnaGJvcmhvb2QuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uZWlnaGJvcmhvb2Q7XG4gIGxpLmFwcGVuZChuZWlnaGJvcmhvb2QpO1xuXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcbiAgYWRkcmVzcy5jbGFzc05hbWUgPSBcImNhcmRfX2Rlc2NyaXB0aW9uXCI7XG4gIGFkZHJlc3MuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5hZGRyZXNzO1xuICBsaS5hcHBlbmQoYWRkcmVzcyk7XG5cbiAgY29uc3QgbW9yZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpO1xuICBtb3JlLmNsYXNzTmFtZSA9IFwiY2FyZF9fYnV0dG9uXCI7XG4gIG1vcmUuc2V0QXR0cmlidXRlKCdyb2xlJywgJ2J1dHRvbicpO1xuICBtb3JlLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdHbyB0byByZXN0YXVyYW50IGRldGFpbHMnKTtcbiAgbW9yZS5pbm5lckhUTUwgPSBcIlZpZXcgRGV0YWlsc1wiO1xuICBtb3JlLmhyZWYgPSBEQkhlbHBlci51cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xuICBsaS5hcHBlbmQobW9yZSk7XG5cbiAgcmV0dXJuIGxpO1xufTtcblxuLyoqXG4gKiBBZGQgbWFya2VycyBmb3IgY3VycmVudCByZXN0YXVyYW50cyB0byB0aGUgbWFwLlxuICovXG5hZGRNYXJrZXJzVG9NYXAgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XG4gIHJlc3RhdXJhbnRzLmZvckVhY2gocmVzdGF1cmFudCA9PiB7XG4gICAgLy8gQWRkIG1hcmtlciB0byB0aGUgbWFwXG4gICAgY29uc3QgbWFya2VyID0gREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBzZWxmLm1hcCk7XG4gICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCBcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gbWFya2VyLnVybDtcbiAgICB9KTtcbiAgICBzZWxmLm1hcmtlcnMucHVzaChtYXJrZXIpO1xuICB9KTtcbn07XG5cbi8qKlxuICogVG9vZ2xlIE1hcFxuICovXG5cbnRvZ2dsZU1hcCA9ICgpID0+IHtcbiAgY29uc3QgbWFwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYXBcIik7XG4gIGNvbnN0IGJ0bk1hcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4tbWFwJyk7XG4gIGlmIChtYXAuc3R5bGUuZGlzcGxheSA9PT0gJ25vbmUnKSB7XG4gICAgc2hvd01hcCA9IHRydWU7XG4gICAgYnRuTWFwLmlubmVyVGV4dCA9ICdIaWRlIE1hcCc7XG4gICAgYnRuTWFwLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdIaWRlIE1hcCcpO1xuICAgIG1hcC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICB3aW5kb3cuaW5pdE1hcCgpO1xuICB9IGVsc2Uge1xuICAgIHNob3dNYXAgPSBmYWxzZTtcbiAgICBidG5NYXAuaW5uZXJUZXh0ID0gJ1Nob3cgTWFwJztcbiAgICBidG5NYXAuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ1Nob3cgTWFwJyk7XG4gICAgbWFwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gIH1cbn1cblxuLyoqXG4gKiBSZWdpc3RlciBTZXJ2aWNlIFdvcmtlclxuICovXG5cbnJlZ2lzdGVyU2VydmljZVdvcmtlciA9ICgpID0+IHtcbiAgaWYgKFwic2VydmljZVdvcmtlclwiIGluIG5hdmlnYXRvcikge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCAoKSA9PiB7XG4gICAgICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlclxuICAgICAgICAucmVnaXN0ZXIoXCIvc3cuanNcIilcbiAgICAgICAgLnRoZW4ocmVnID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnU2VydmljZVdvcmtlciByZWdpc3RyYXRpb24gc3VjY2Vzc2Z1bCB3aXRoIHNjb3BlOiAnLCByZWcuc2NvcGUpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICAvLyByZWcgZmFpbGVkIDooXG4gICAgICAgICAgY29uc29sZS5sb2coXCJTZXJ2aWNlIFdvcmtlciBmYWlsZWQ6IFwiLCBlcnIpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLmxvZygnPT0gU2VydmljZSBXb3JrZXIgbm90IHN1cHBvcnRlZCA9PScpO1xuICB9XG59Il19
