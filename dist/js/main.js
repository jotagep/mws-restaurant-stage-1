let restaurants,neighborhoods,cuisines,showMap=!1;var map,markers=[];const myLazyLoad=new LazyLoad;document.addEventListener("DOMContentLoaded",e=>{registerServiceWorker(),fetchNeighborhoods(),fetchCuisines(),updateRestaurants()}),fetchNeighborhoods=(()=>{DBHelper.fetchNeighborhoods((e,t)=>{e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})}),fillNeighborhoodsHTML=((e=self.neighborhoods)=>{const t=document.getElementById("neighborhoods-select");e.forEach(e=>{const a=document.createElement("option");a.innerHTML=e,a.value=e,t.append(a)})}),fetchCuisines=(()=>{DBHelper.fetchCuisines((e,t)=>{e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})}),fillCuisinesHTML=((e=self.cuisines)=>{const t=document.getElementById("cuisines-select");e.forEach(e=>{const a=document.createElement("option");a.innerHTML=e,a.value=e,t.append(a)})}),window.initMap=(()=>{self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),addMarkersToMap()}),updateRestaurants=(()=>{const e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),a=e.selectedIndex,n=t.selectedIndex,s=e[a].value,r=t[n].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(s,r,(e,t)=>{e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML(),myLazyLoad.update())})}),resetRestaurants=(e=>{self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(e=>e.setMap(null)),self.markers=[],self.restaurants=e}),fillRestaurantsHTML=((e=self.restaurants)=>{const t=document.getElementById("restaurants-list");e.forEach(e=>{t.append(createRestaurantHTML(e))}),showMap&&addMarkersToMap()}),createRestaurantHTML=(e=>{const t=document.createElement("li");t.className="card";const a=document.createElement("picture");t.append(a);const n=document.createElement("source");n.type="image/webp",n.setAttribute("data-srcset",`${DBHelper.imageRespForRestaurant(e,"large","webp")}`),n.media="(min-width: 511px) and (max-width: 640px)",a.append(n);const s=document.createElement("source");s.type="image/webp",s.setAttribute("data-srcset",`${DBHelper.imageRespForRestaurant(e,"medium","webp")}`),s.media="(min-width: 411px) and (max-width: 510px),\n                       (min-width: 791px) and (max-width: 930px),\n                       (min-width: 1191px)",a.append(s);const r=document.createElement("source");r.type="image/webp",r.setAttribute("data-srcset",`${DBHelper.imageRespForRestaurant(e,"small","webp")}`),r.media="(max-width: 410px),\n                       (min-width: 650px) and (max-width: 800px),\n                       (min-width: 950px) and (max-width: 1200px)",a.append(r);const o=document.createElement("source");o.type="image/jpeg",o.setAttribute("data-srcset",`${DBHelper.imageRespForRestaurant(e,"large")}`),o.media="(min-width: 511px) and (max-width: 640px)",a.append(o);const i=document.createElement("source");i.type="image/jpeg",i.setAttribute("data-srcset",`${DBHelper.imageRespForRestaurant(e,"medium")}`),i.media="(min-width: 411px) and (max-width: 510px),\n                         (min-width: 791px) and (max-width: 930px),\n                         (min-width: 1191px)",a.append(i);const d=document.createElement("img");d.type="image/jpeg",d.className="card__img",d.setAttribute("data-src",`${DBHelper.imageRespForRestaurant(e,"small")}`),d.media="(max-width: 410px),\n                         (min-width: 650px) and (max-width: 800px),\n                         (min-width: 950px) and (max-width: 1200px)",d.alt=`${e.name}`,a.append(d);const c=document.createElement("h3");c.className="card__title",c.innerHTML=e.name,t.append(c);const l=document.createElement("p");l.className="card__description",l.innerHTML=e.neighborhood,t.append(l);const p=document.createElement("p");p.className="card__description",p.innerHTML=e.address,t.append(p);const m=document.createElement("a");return m.className="card__button",m.setAttribute("role","button"),m.setAttribute("aria-label","Go to restaurant details"),m.innerHTML="View Details",m.href=DBHelper.urlForRestaurant(e),t.append(m),t}),addMarkersToMap=((e=self.restaurants)=>{e.forEach(e=>{const t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",()=>{window.location.href=t.url}),self.markers.push(t)})}),toggleMap=(()=>{const e=document.getElementById("map"),t=document.getElementById("btn-map");"none"===e.style.display?(showMap=!0,t.innerText="Hide Map",e.style.display="block",window.initMap()):(showMap=!1,t.innerText="Show Map",e.style.display="none")}),registerServiceWorker=(()=>{"serviceWorker"in navigator?window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("ServiceWorker registration successful with scope: ",e.scope)}).catch(e=>{console.log("Service Worker failed: ",e)})}):console.log("== Service Worker not supported ==")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsicmVzdGF1cmFudHMiLCJuZWlnaGJvcmhvb2RzIiwiY3Vpc2luZXMiLCJzaG93TWFwIiwibWFwIiwibWFya2VycyIsIm15TGF6eUxvYWQiLCJMYXp5TG9hZCIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwicmVnaXN0ZXJTZXJ2aWNlV29ya2VyIiwiZmV0Y2hOZWlnaGJvcmhvb2RzIiwiZmV0Y2hDdWlzaW5lcyIsInVwZGF0ZVJlc3RhdXJhbnRzIiwiREJIZWxwZXIiLCJlcnJvciIsImNvbnNvbGUiLCJzZWxmIiwiZmlsbE5laWdoYm9yaG9vZHNIVE1MIiwic2VsZWN0IiwiZ2V0RWxlbWVudEJ5SWQiLCJmb3JFYWNoIiwibmVpZ2hib3Job29kIiwib3B0aW9uIiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsInZhbHVlIiwiYXBwZW5kIiwiZmlsbEN1aXNpbmVzSFRNTCIsImN1aXNpbmUiLCJ3aW5kb3ciLCJpbml0TWFwIiwiZ29vZ2xlIiwibWFwcyIsIk1hcCIsInpvb20iLCJjZW50ZXIiLCJsYXQiLCJsbmciLCJzY3JvbGx3aGVlbCIsImFkZE1hcmtlcnNUb01hcCIsImNTZWxlY3QiLCJuU2VsZWN0IiwiY0luZGV4Iiwic2VsZWN0ZWRJbmRleCIsIm5JbmRleCIsImZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZCIsInJlc2V0UmVzdGF1cmFudHMiLCJmaWxsUmVzdGF1cmFudHNIVE1MIiwidXBkYXRlIiwibSIsInNldE1hcCIsInVsIiwicmVzdGF1cmFudCIsImNyZWF0ZVJlc3RhdXJhbnRIVE1MIiwibGkiLCJjbGFzc05hbWUiLCJwaWN0dXJlIiwiV2VicF9sYXJnZSIsInR5cGUiLCJzZXRBdHRyaWJ1dGUiLCJpbWFnZVJlc3BGb3JSZXN0YXVyYW50IiwibWVkaWEiLCJXZWJQX21lZGl1bSIsIldlYlBfc21hbGwiLCJKcGdfbGFyZ2UiLCJKcGdfbWVkaXVtIiwiaW1hZ2Vfc21hbGwiLCJhbHQiLCJuYW1lIiwiYWRkcmVzcyIsIm1vcmUiLCJocmVmIiwidXJsRm9yUmVzdGF1cmFudCIsIm1hcmtlciIsIm1hcE1hcmtlckZvclJlc3RhdXJhbnQiLCJhZGRMaXN0ZW5lciIsImxvY2F0aW9uIiwidXJsIiwicHVzaCIsInRvZ2dsZU1hcCIsImJ0bk1hcCIsInN0eWxlIiwiZGlzcGxheSIsImlubmVyVGV4dCIsIm5hdmlnYXRvciIsInNlcnZpY2VXb3JrZXIiLCJyZWdpc3RlciIsInRoZW4iLCJyZWciLCJsb2ciLCJzY29wZSIsImNhdGNoIiwiZXJyIl0sIm1hcHBpbmdzIjoiQUFBQSxJQUFJQSxZQUFhQyxjQUFlQyxTQUM1QkMsU0FBVSxFQUNkLElBQUlDLElBQ0FDLFdBRUosTUFBTUMsV0FBYSxJQUFJQyxTQUt2QkMsU0FBU0MsaUJBQWlCLG1CQUFvQkMsSUFDNUNDLHdCQUNBQyxxQkFDQUMsZ0JBQ0FDLHNCQU1GRixtQkFBcUIsTUFDbkJHLFNBQVNILG1CQUFtQixDQUFDSSxFQUFPZixLQUM5QmUsRUFFRkMsUUFBUUQsTUFBTUEsSUFFZEUsS0FBS2pCLGNBQWdCQSxFQUNyQmtCLDZCQVFOQSxzQkFBd0IsRUFBQ2xCLEVBQWdCaUIsS0FBS2pCLGlCQUM1QyxNQUFNbUIsRUFBU1osU0FBU2EsZUFBZSx3QkFDdkNwQixFQUFjcUIsUUFBUUMsSUFDcEIsTUFBTUMsRUFBU2hCLFNBQVNpQixjQUFjLFVBQ3RDRCxFQUFPRSxVQUFZSCxFQUNuQkMsRUFBT0csTUFBUUosRUFDZkgsRUFBT1EsT0FBT0osT0FPbEJYLGNBQWdCLE1BQ2RFLFNBQVNGLGNBQWMsQ0FBQ0csRUFBT2QsS0FDekJjLEVBRUZDLFFBQVFELE1BQU1BLElBRWRFLEtBQUtoQixTQUFXQSxFQUNoQjJCLHdCQVFOQSxpQkFBbUIsRUFBQzNCLEVBQVdnQixLQUFLaEIsWUFDbEMsTUFBTWtCLEVBQVNaLFNBQVNhLGVBQWUsbUJBRXZDbkIsRUFBU29CLFFBQVFRLElBQ2YsTUFBTU4sRUFBU2hCLFNBQVNpQixjQUFjLFVB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QzlCNkUsVUFBVUMsY0FDUEMsU0FBUyxVQUNUQyxLQUFLQyxJQUNKekUsUUFBUTBFLElBQUkscURBQXNERCxFQUFJRSxTQUV2RUMsTUFBTUMsSUFFTDdFLFFBQVEwRSxJQUFJLDBCQUEyQkcsT0FJN0M3RSxRQUFRMEUsSUFBSSIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IHJlc3RhdXJhbnRzLCBuZWlnaGJvcmhvb2RzLCBjdWlzaW5lcztcbmxldCBzaG93TWFwID0gZmFsc2U7XG52YXIgbWFwO1xudmFyIG1hcmtlcnMgPSBbXTtcblxuY29uc3QgbXlMYXp5TG9hZCA9IG5ldyBMYXp5TG9hZCgpO1xuXG4vKipcbiAqIEZldGNoIG5laWdoYm9yaG9vZHMgYW5kIGN1aXNpbmVzIGFzIHNvb24gYXMgdGhlIHBhZ2UgaXMgbG9hZGVkLlxuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBldmVudCA9PiB7XG4gIHJlZ2lzdGVyU2VydmljZVdvcmtlcigpO1xuICBmZXRjaE5laWdoYm9yaG9vZHMoKTtcbiAgZmV0Y2hDdWlzaW5lcygpO1xuICB1cGRhdGVSZXN0YXVyYW50cygpO1xufSk7XG5cbi8qKlxuICogRmV0Y2ggYWxsIG5laWdoYm9yaG9vZHMgYW5kIHNldCB0aGVpciBIVE1MLlxuICovXG5mZXRjaE5laWdoYm9yaG9vZHMgPSAoKSA9PiB7XG4gIERCSGVscGVyLmZldGNoTmVpZ2hib3Job29kcygoZXJyb3IsIG5laWdoYm9yaG9vZHMpID0+IHtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIC8vIEdvdCBhbiBlcnJvclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNlbGYubmVpZ2hib3Job29kcyA9IG5laWdoYm9yaG9vZHM7XG4gICAgICBmaWxsTmVpZ2hib3Job29kc0hUTUwoKTtcbiAgICB9XG4gIH0pO1xufTtcblxuLyoqXG4gKiBTZXQgbmVpZ2hib3Job29kcyBIVE1MLlxuICovXG5maWxsTmVpZ2hib3Job29kc0hUTUwgPSAobmVpZ2hib3Job29kcyA9IHNlbGYubmVpZ2hib3Job29kcykgPT4ge1xuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5laWdoYm9yaG9vZHMtc2VsZWN0XCIpO1xuICBuZWlnaGJvcmhvb2RzLmZvckVhY2gobmVpZ2hib3Job29kID0+IHtcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIpO1xuICAgIG9wdGlvbi5pbm5lckhUTUwgPSBuZWlnaGJvcmhvb2Q7XG4gICAgb3B0aW9uLnZhbHVlID0gbmVpZ2hib3Job29kO1xuICAgIHNlbGVjdC5hcHBlbmQob3B0aW9uKTtcbiAgfSk7XG59O1xuXG4vKipcbiAqIEZldGNoIGFsbCBjdWlzaW5lcyBhbmQgc2V0IHRoZWlyIEhUTUwuXG4gKi9cbmZldGNoQ3Vpc2luZXMgPSAoKSA9PiB7XG4gIERCSGVscGVyLmZldGNoQ3Vpc2luZXMoKGVycm9yLCBjdWlzaW5lcykgPT4ge1xuICAgIGlmIChlcnJvcikge1xuICAgICAgLy8gR290IGFuIGVycm9yIVxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNlbGYuY3Vpc2luZXMgPSBjdWlzaW5lcztcbiAgICAgIGZpbGxDdWlzaW5lc0hUTUwoKTtcbiAgICB9XG4gIH0pO1xufTtcblxuLyoqXG4gKiBTZXQgY3Vpc2luZXMgSFRNTC5cbiAqL1xuZmlsbEN1aXNpbmVzSFRNTCA9IChjdWlzaW5lcyA9IHNlbGYuY3Vpc2luZXMpID0+IHtcbiAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjdWlzaW5lcy1zZWxlY3RcIik7XG5cbiAgY3Vpc2luZXMuZm9yRWFjaChjdWlzaW5lID0+IHtcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIpO1xuICAgIG9wdGlvbi5pbm5lckhUTUwgPSBjdWlzaW5lO1xuICAgIG9wdGlvbi52YWx1ZSA9IGN1aXNpbmU7XG4gICAgc2VsZWN0LmFwcGVuZChvcHRpb24pO1xuICB9KTtcbn07XG5cbi8qKlxuICogSW5pdGlhbGl6ZSBHb29nbGUgbWFwLCBjYWxsZWQgZnJvbSBIVE1MLlxuICovXG53aW5kb3cuaW5pdE1hcCA9ICgpID0+IHtcbiAgbGV0IGxvYyA9IHtcbiAgICBsYXQ6IDQwLjcyMjIxNixcbiAgICBsbmc6IC03My45ODc1MDFcbiAgfTtcbiAgc2VsZi5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWFwXCIpLCB7XG4gICAgem9vbTogMTIsXG4gICAgY2VudGVyOiBsb2MsXG4gICAgc2Nyb2xsd2hlZWw6IGZhbHNlXG4gIH0pO1xuICBhZGRNYXJrZXJzVG9NYXAoKTtcbn07XG5cbi8qKlxuICogVXBkYXRlIHBhZ2UgYW5kIG1hcCBmb3IgY3VycmVudCByZXN0YXVyYW50cy5cbiAqL1xudXBkYXRlUmVzdGF1cmFudHMgPSAoKSA9PiB7XG4gIGNvbnN0IGNTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImN1aXNpbmVzLXNlbGVjdFwiKTtcbiAgY29uc3QgblNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmVpZ2hib3Job29kcy1zZWxlY3RcIik7XG5cbiAgY29uc3QgY0luZGV4ID0gY1NlbGVjdC5zZWxlY3RlZEluZGV4O1xuICBjb25zdCBuSW5kZXggPSBuU2VsZWN0LnNlbGVjdGVkSW5kZXg7XG5cbiAgY29uc3QgY3Vpc2luZSA9IGNTZWxlY3RbY0luZGV4XS52YWx1ZTtcbiAgY29uc3QgbmVpZ2hib3Job29kID0gblNlbGVjdFtuSW5kZXhdLnZhbHVlO1xuXG4gIERCSGVscGVyLmZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZChcbiAgICBjdWlzaW5lLFxuICAgIG5laWdoYm9yaG9vZCxcbiAgICAoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgLy8gR290IGFuIGVycm9yIVxuICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc2V0UmVzdGF1cmFudHMocmVzdGF1cmFudHMpO1xuICAgICAgICBmaWxsUmVzdGF1cmFudHNIVE1MKCk7XG4gICAgICAgIG15TGF6eUxvYWQudXBkYXRlKCk7XG4gICAgICB9XG4gICAgfVxuICApO1xufTtcblxuLyoqXG4gKiBDbGVhciBjdXJyZW50IHJlc3RhdXJhbnRzLCB0aGVpciBIVE1MIGFuZCByZW1vdmUgdGhlaXIgbWFwIG1hcmtlcnMuXG4gKi9cbnJlc2V0UmVzdGF1cmFudHMgPSByZXN0YXVyYW50cyA9PiB7XG4gIC8vIFJlbW92ZSBhbGwgcmVzdGF1cmFudHNcbiAgc2VsZi5yZXN0YXVyYW50cyA9IFtdO1xuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVzdGF1cmFudHMtbGlzdFwiKTtcbiAgdWwuaW5uZXJIVE1MID0gXCJcIjtcblxuICAvLyBSZW1vdmUgYWxsIG1hcCBtYXJrZXJzXG4gIHNlbGYubWFya2Vycy5mb3JFYWNoKG0gPT4gbS5zZXRNYXAobnVsbCkpO1xuICBzZWxmLm1hcmtlcnMgPSBbXTtcbiAgc2VsZi5yZXN0YXVyYW50cyA9IHJlc3RhdXJhbnRzO1xufTtcblxuLyoqXG4gKiBDcmVhdGUgYWxsIHJlc3RhdXJhbnRzIEhUTUwgYW5kIGFkZCB0aGVtIHRvIHRoZSB3ZWJwYWdlLlxuICovXG5maWxsUmVzdGF1cmFudHNIVE1MID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVzdGF1cmFudHMtbGlzdFwiKTtcbiAgcmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcbiAgICB1bC5hcHBlbmQoY3JlYXRlUmVzdGF1cmFudEhUTUwocmVzdGF1cmFudCkpO1xuICB9KTtcbiAgaWYgKHNob3dNYXApIHtcbiAgICBhZGRNYXJrZXJzVG9NYXAoKTtcbiAgfVxufTtcblxuLyoqXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBIVE1MLlxuICovXG5jcmVhdGVSZXN0YXVyYW50SFRNTCA9IHJlc3RhdXJhbnQgPT4ge1xuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaVwiKTtcbiAgbGkuY2xhc3NOYW1lID0gXCJjYXJkXCI7XG5cbiAgY29uc3QgcGljdHVyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwaWN0dXJlXCIpO1xuICBsaS5hcHBlbmQocGljdHVyZSk7XG5cbiAgLyogU291cmNlcyBXZWJQIEltYWdlcyAqL1xuICBjb25zdCBXZWJwX2xhcmdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNvdXJjZVwiKTtcbiAgV2VicF9sYXJnZS50eXBlID0gXCJpbWFnZS93ZWJwXCI7XG4gIFdlYnBfbGFyZ2Uuc2V0QXR0cmlidXRlKCdkYXRhLXNyY3NldCcsIGAke0RCSGVscGVyLmltYWdlUmVzcEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgJ2xhcmdlJywgJ3dlYnAnKX1gKTtcbiAgV2VicF9sYXJnZS5tZWRpYSA9IGAobWluLXdpZHRoOiA1MTFweCkgYW5kIChtYXgtd2lkdGg6IDY0MHB4KWA7XG4gIHBpY3R1cmUuYXBwZW5kKFdlYnBfbGFyZ2UpO1xuXG4gIGNvbnN0IFdlYlBfbWVkaXVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNvdXJjZVwiKTtcbiAgV2ViUF9tZWRpdW0udHlwZSA9IFwiaW1hZ2Uvd2VicFwiO1xuICBXZWJQX21lZGl1bS5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3Jjc2V0JywgYCR7REJIZWxwZXIuaW1hZ2VSZXNwRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCAnbWVkaXVtJywgJ3dlYnAnKX1gKTtcbiAgV2ViUF9tZWRpdW0ubWVkaWEgPSBgKG1pbi13aWR0aDogNDExcHgpIGFuZCAobWF4LXdpZHRoOiA1MTBweCksXG4gICAgICAgICAgICAgICAgICAgICAgIChtaW4td2lkdGg6IDc5MXB4KSBhbmQgKG1heC13aWR0aDogOTMwcHgpLFxuICAgICAgICAgICAgICAgICAgICAgICAobWluLXdpZHRoOiAxMTkxcHgpYDtcbiAgcGljdHVyZS5hcHBlbmQoV2ViUF9tZWRpdW0pO1xuXG4gIGNvbnN0IFdlYlBfc21hbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic291cmNlXCIpO1xuICBXZWJQX3NtYWxsLnR5cGUgPSBcImltYWdlL3dlYnBcIjtcbiAgV2ViUF9zbWFsbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3Jjc2V0JywgYCR7REJIZWxwZXIuaW1hZ2VSZXNwRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCAnc21hbGwnLCAnd2VicCcpfWApO1xuICBXZWJQX3NtYWxsLm1lZGlhID0gYChtYXgtd2lkdGg6IDQxMHB4KSxcbiAgICAgICAgICAgICAgICAgICAgICAgKG1pbi13aWR0aDogNjUwcHgpIGFuZCAobWF4LXdpZHRoOiA4MDBweCksXG4gICAgICAgICAgICAgICAgICAgICAgIChtaW4td2lkdGg6IDk1MHB4KSBhbmQgKG1heC13aWR0aDogMTIwMHB4KWA7XG4gIHBpY3R1cmUuYXBwZW5kKFdlYlBfc21hbGwpO1xuXG4gIC8qIFNvdXJjZXMgSlBFRyBJbWFnZXMgKi9cbiAgY29uc3QgSnBnX2xhcmdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNvdXJjZVwiKTtcbiAgSnBnX2xhcmdlLnR5cGUgPSBcImltYWdlL2pwZWdcIjtcbiAgSnBnX2xhcmdlLnNldEF0dHJpYnV0ZSgnZGF0YS1zcmNzZXQnLCBgJHtEQkhlbHBlci5pbWFnZVJlc3BGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsICdsYXJnZScpfWApO1xuICBKcGdfbGFyZ2UubWVkaWEgPSBgKG1pbi13aWR0aDogNTExcHgpIGFuZCAobWF4LXdpZHRoOiA2NDBweClgO1xuICBwaWN0dXJlLmFwcGVuZChKcGdfbGFyZ2UpO1xuXG4gIGNvbnN0IEpwZ19tZWRpdW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic291cmNlXCIpO1xuICBKcGdfbWVkaXVtLnR5cGUgPSBcImltYWdlL2pwZWdcIjtcbiAgSnBnX21lZGl1bS5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3Jjc2V0JywgYCR7REJIZWxwZXIuaW1hZ2VSZXNwRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCAnbWVkaXVtJyl9YCk7XG4gIEpwZ19tZWRpdW0ubWVkaWEgPSBgKG1pbi13aWR0aDogNDExcHgpIGFuZCAobWF4LXdpZHRoOiA1MTBweCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgKG1pbi13aWR0aDogNzkxcHgpIGFuZCAobWF4LXdpZHRoOiA5MzBweCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgKG1pbi13aWR0aDogMTE5MXB4KWA7XG4gIHBpY3R1cmUuYXBwZW5kKEpwZ19tZWRpdW0pO1xuXG4gIGNvbnN0IGltYWdlX3NtYWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImltZ1wiKTtcbiAgaW1hZ2Vfc21hbGwudHlwZSA9IFwiaW1hZ2UvanBlZ1wiO1xuICBpbWFnZV9zbWFsbC5jbGFzc05hbWUgPSBcImNhcmRfX2ltZ1wiO1xuICBpbWFnZV9zbWFsbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3JjJywgYCR7REJIZWxwZXIuaW1hZ2VSZXNwRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCAnc21hbGwnKX1gKTtcbiAgaW1hZ2Vfc21hbGwubWVkaWEgPSBgKG1heC13aWR0aDogNDEwcHgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgIChtaW4td2lkdGg6IDY1MHB4KSBhbmQgKG1heC13aWR0aDogODAwcHgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgIChtaW4td2lkdGg6IDk1MHB4KSBhbmQgKG1heC13aWR0aDogMTIwMHB4KWA7XG4gIGltYWdlX3NtYWxsLmFsdCA9IGAke3Jlc3RhdXJhbnQubmFtZX1gO1xuICBwaWN0dXJlLmFwcGVuZChpbWFnZV9zbWFsbCk7XG5cbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoM1wiKTtcbiAgbmFtZS5jbGFzc05hbWUgPSBcImNhcmRfX3RpdGxlXCI7XG4gIG5hbWUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xuICBsaS5hcHBlbmQobmFtZSk7XG5cbiAgY29uc3QgbmVpZ2hib3Job29kID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XG4gIG5laWdoYm9yaG9vZC5jbGFzc05hbWUgPSBcImNhcmRfX2Rlc2NyaXB0aW9uXCI7XG4gIG5laWdoYm9yaG9vZC5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5laWdoYm9yaG9vZDtcbiAgbGkuYXBwZW5kKG5laWdoYm9yaG9vZCk7XG5cbiAgY29uc3QgYWRkcmVzcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xuICBhZGRyZXNzLmNsYXNzTmFtZSA9IFwiY2FyZF9fZGVzY3JpcHRpb25cIjtcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3M7XG4gIGxpLmFwcGVuZChhZGRyZXNzKTtcblxuICBjb25zdCBtb3JlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIik7XG4gIG1vcmUuY2xhc3NOYW1lID0gXCJjYXJkX19idXR0b25cIjtcbiAgbW9yZS5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnYnV0dG9uJyk7XG4gIG1vcmUuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ0dvIHRvIHJlc3RhdXJhbnQgZGV0YWlscycpO1xuICBtb3JlLmlubmVySFRNTCA9IFwiVmlldyBEZXRhaWxzXCI7XG4gIG1vcmUuaHJlZiA9IERCSGVscGVyLnVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XG4gIGxpLmFwcGVuZChtb3JlKTtcblxuICByZXR1cm4gbGk7XG59O1xuXG4vKipcbiAqIEFkZCBtYXJrZXJzIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzIHRvIHRoZSBtYXAuXG4gKi9cbmFkZE1hcmtlcnNUb01hcCA9IChyZXN0YXVyYW50cyA9IHNlbGYucmVzdGF1cmFudHMpID0+IHtcbiAgcmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcbiAgICAvLyBBZGQgbWFya2VyIHRvIHRoZSBtYXBcbiAgICBjb25zdCBtYXJrZXIgPSBEQkhlbHBlci5tYXBNYXJrZXJGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIHNlbGYubWFwKTtcbiAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsIFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBtYXJrZXIudXJsO1xuICAgIH0pO1xuICAgIHNlbGYubWFya2Vycy5wdXNoKG1hcmtlcik7XG4gIH0pO1xufTtcblxuLyoqXG4gKiBUb29nbGUgTWFwXG4gKi9cblxudG9nZ2xlTWFwID0gKCkgPT4ge1xuICBjb25zdCBtYXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1hcFwiKTtcbiAgY29uc3QgYnRuTWFwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1tYXAnKTtcbiAgaWYgKG1hcC5zdHlsZS5kaXNwbGF5ID09PSAnbm9uZScpIHtcbiAgICBzaG93TWFwID0gdHJ1ZTtcbiAgICBidG5NYXAuaW5uZXJUZXh0ID0gJ0hpZGUgTWFwJztcbiAgICBtYXAuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgd2luZG93LmluaXRNYXAoKTtcbiAgfSBlbHNlIHtcbiAgICBzaG93TWFwID0gZmFsc2U7XG4gICAgYnRuTWFwLmlubmVyVGV4dCA9ICdTaG93IE1hcCc7XG4gICAgbWFwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gIH1cbn1cblxuLyoqXG4gKiBSZWdpc3RlciBTZXJ2aWNlIFdvcmtlclxuICovXG5cbnJlZ2lzdGVyU2VydmljZVdvcmtlciA9ICgpID0+IHtcbiAgaWYgKFwic2VydmljZVdvcmtlclwiIGluIG5hdmlnYXRvcikge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCAoKSA9PiB7XG4gICAgICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlclxuICAgICAgICAucmVnaXN0ZXIoXCIvc3cuanNcIilcbiAgICAgICAgLnRoZW4ocmVnID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnU2VydmljZVdvcmtlciByZWdpc3RyYXRpb24gc3VjY2Vzc2Z1bCB3aXRoIHNjb3BlOiAnLCByZWcuc2NvcGUpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICAvLyByZWcgZmFpbGVkIDooXG4gICAgICAgICAgY29uc29sZS5sb2coXCJTZXJ2aWNlIFdvcmtlciBmYWlsZWQ6IFwiLCBlcnIpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLmxvZygnPT0gU2VydmljZSBXb3JrZXIgbm90IHN1cHBvcnRlZCA9PScpO1xuICB9XG59Il19
